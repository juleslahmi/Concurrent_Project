import matplotlib.pyplot as plt

# ---- Raw Data ----
pair_forces_data = [
    (10,1,0.139237), (10,2,0.174114), (10,4,0.228911), (10,6,0.521461), (10,8,0.515708),
    (50,1,0.172627), (50,2,0.169892), (50,4,0.270707), (50,6,0.384432), (50,8,0.516895),
    (100,1,0.383561), (100,2,0.385932), (100,4,0.335901), (100,6,0.465297), (100,8,0.627715),
    (200,1,1.49584), (200,2,1.35013), (200,4,1.08836), (200,6,0.999013), (200,8,0.956969),
    (500,1,20.1611), (500,2,12.4295), (500,4,12.3415), (500,6,6.87122), (500,8,6.20008),
    (1000,1,132.695), (1000,2,106.129), (1000,4,72.7499), (1000,6,53.6498), (1000,8,51.124),
    (2000,1,1002.97), (2000,2,843.086), (2000,4,583.984), (2000,6,491.218), (2000,8,498.255),
]

thread_local_linear = [
    (10,1,0.0946502), (10,2,0.123368), (10,4,0.19964), (10,6,0.343261), (10,8,0.519569),
    (50,1,0.173175), (50,2,0.241916), (50,4,0.489648), (50,6,1.05892), (50,8,1.31767),
    (100,1,0.758278), (100,2,0.595939), (100,4,0.594533), (100,6,0.840558), (100,8,1.05023),
    (200,1,2.80138), (200,2,1.56178), (200,4,1.90496), (200,6,1.67494), (200,8,1.92379),
    (500,1,15.2315), (500,2,14.9024), (500,4,9.36824), (500,6,8.164), (500,8,8.60882),
    (1000,1,78.1172), (1000,2,60.6749), (1000,4,47.6238), (1000,6,44.8414), (1000,8,52.5573),
    (2000,1,670.78), (2000,2,534.354), (2000,4,354.542), (2000,6,301.671), (2000,8,287.875),
]

thread_local_parallel = [
    (10,1,0.11694), (10,2,0.204793), (10,4,0.347504), (10,6,0.5805), (10,8,1.13319),
    (50,1,0.117577), (50,2,0.23536), (50,4,0.376385), (50,6,0.668504), (50,8,1.11744),
    (100,1,0.208383), (100,2,0.750023), (100,4,0.452683), (100,6,0.68119), (100,8,0.864949),
    (200,1,1.49126), (200,2,0.950645), (200,4,0.796628), (200,6,1.23756), (200,8,1.0809),
    (500,1,11.9191), (500,2,8.66667), (500,4,7.53361), (500,6,6.53922), (500,8,7.41798),
    (1000,1,77.5687), (1000,2,59.3895), (1000,4,41.235), (1000,6,35.9339), (1000,8,34.3638),
    (2000,1,580.551), (2000,2,471.259), (2000,4,365.592), (2000,6,294.844), (2000,8,263.896),
]

methods = {
    "Pair Forces": pair_forces_data,
    "Thread Local (Linear)": thread_local_linear,
    "Thread Local (Parallel)": thread_local_parallel,
}

# ---- Plotting ----
import matplotlib.pyplot as plt
import math

body_counts = sorted(set(b for (b, _, _) in pair_forces_data))
num_plots = len(body_counts)
cols = 2
rows = math.ceil(num_plots / cols)

fig, axs = plt.subplots(rows, cols, figsize=(14, 3 * rows))
axs = axs.flatten()

for idx, body_count in enumerate(body_counts):
    ax = axs[idx]
    for method_name, dataset in methods.items():
        data = [(t, time) for b, t, time in dataset if b == body_count]
        data.sort()
        threads, times = zip(*data)
        ax.plot(threads, times, label=method_name, marker='o')

    ax.set_title(f"Time vs Threads (Bodies = {body_count})")
    ax.set_xlabel("Threads")
    ax.set_ylabel("Time (s)")
    ax.legend()
    ax.grid(True)

# Hide extra plots
for ax in axs[num_plots:]:
    ax.set_visible(False)

plt.tight_layout()
plt.show()
